![SVG Banners](https://svg-banners.vercel.app/api?type=origin&text1=CosyVoiceğŸ¤ &text2=Text-to-Speech%20ğŸ’–%20Large%20Language%20Model&width=800&height=210)

**[English version / è‹±èªç‰ˆ README](README.md)**

## ğŸ‘‰ğŸ» CosyVoice ğŸ‘ˆğŸ»

**Fun-CosyVoice 3.0**: [ãƒ‡ãƒ¢](https://funaudiollm.github.io/cosyvoice3/); [è«–æ–‡](https://arxiv.org/pdf/2505.17589); [Modelscope](https://www.modelscope.cn/models/FunAudioLLM/Fun-CosyVoice3-0.5B-2512); [Huggingface](https://huggingface.co/FunAudioLLM/Fun-CosyVoice3-0.5B-2512); [CV3-Eval](https://github.com/FunAudioLLM/CV3-Eval)

**CosyVoice 2.0**: [ãƒ‡ãƒ¢](https://funaudiollm.github.io/cosyvoice2/); [è«–æ–‡](https://arxiv.org/pdf/2412.10117); [Modelscope](https://www.modelscope.cn/models/iic/CosyVoice2-0.5B); [HuggingFace](https://huggingface.co/FunAudioLLM/CosyVoice2-0.5B)

**CosyVoice 1.0**: [ãƒ‡ãƒ¢](https://fun-audio-llm.github.io); [è«–æ–‡](https://funaudiollm.github.io/pdf/CosyVoice_v1.pdf); [Modelscope](https://www.modelscope.cn/models/iic/CosyVoice-300M); [HuggingFace](https://huggingface.co/FunAudioLLM/CosyVoice-300M)

## ãƒã‚¤ãƒ©ã‚¤ãƒˆğŸ”¥

**Fun-CosyVoice 3.0** ã¯å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆLLMï¼‰ã«åŸºã¥ãé«˜åº¦ãªãƒ†ã‚­ã‚¹ãƒˆèª­ã¿ä¸Šã’ï¼ˆTTSï¼‰ã‚·ã‚¹ãƒ†ãƒ ã§ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸€è²«æ€§ã€è©±è€…ã®é¡ä¼¼æ€§ã€ãƒ—ãƒ­ã‚½ãƒ‡ã‚£ã®è‡ªç„¶æ€§ã«ãŠã„ã¦å‰ä»»ï¼ˆCosyVoice 2.0ï¼‰ã‚’ä¸Šå›ã‚‹æ€§èƒ½ã‚’ç™ºæ®ã—ã¾ã™ã€‚ãƒ¯ã‚¤ãƒ«ãƒ‰ãªã‚¼ãƒ­ã‚·ãƒ§ãƒƒãƒˆå¤šè¨€èªéŸ³å£°åˆæˆã®ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½
- **è¨€èªå¯¾å¿œ**: 9ã¤ã®ä¸»è¦è¨€èªï¼ˆä¸­å›½èªã€è‹±èªã€æ—¥æœ¬èªã€éŸ“å›½èªã€ãƒ‰ã‚¤ãƒ„èªã€ã‚¹ãƒšã‚¤ãƒ³èªã€ãƒ•ãƒ©ãƒ³ã‚¹èªã€ã‚¤ã‚¿ãƒªã‚¢èªã€ãƒ­ã‚·ã‚¢èªï¼‰ã€18ä»¥ä¸Šã®ä¸­å›½èªæ–¹è¨€/ã‚¢ã‚¯ã‚»ãƒ³ãƒˆï¼ˆåºƒæ±ã€é–©å—ã€å››å·ã€æ±åŒ—ã€é™è¥¿ã€å±±è¥¿ã€ä¸Šæµ·ã€å¤©æ´¥ã€å±±æ±ã€å¯§å¤ã€ç”˜ç²›ãªã©ï¼‰ã‚’ã‚«ãƒãƒ¼ã—ã€å¤šè¨€èª/ã‚¯ãƒ­ã‚¹ãƒªãƒ³ã‚¬ãƒ«ã‚¼ãƒ­ã‚·ãƒ§ãƒƒãƒˆéŸ³å£°ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’åŒæ™‚ã«ã‚µãƒãƒ¼ãƒˆ
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸€è²«æ€§ã¨è‡ªç„¶æ€§**: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¸€è²«æ€§ã€è©±è€…ã®é¡ä¼¼æ€§ã€ãƒ—ãƒ­ã‚½ãƒ‡ã‚£ã®è‡ªç„¶æ€§ã«ãŠã„ã¦æœ€å…ˆç«¯ã®æ€§èƒ½ã‚’é”æˆ
- **ç™ºéŸ³ã‚¤ãƒ³ãƒšã‚¤ãƒ³ãƒ†ã‚£ãƒ³ã‚°**: ä¸­å›½èªãƒ”ãƒ³ã‚¤ãƒ³ã¨è‹±èªCMUéŸ³ç´ ã®ç™ºéŸ³ã‚¤ãƒ³ãƒšã‚¤ãƒ³ãƒ†ã‚£ãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€ã‚ˆã‚Šé«˜ã„åˆ¶å¾¡æ€§ã‚’æä¾›ã™ã‚‹ãŸã‚å®Ÿé‹ç”¨ã«é©ã—ã¦ã„ã‚‹
- **ãƒ†ã‚­ã‚¹ãƒˆæ­£è¦åŒ–**: æ•°å­—ã€ç‰¹æ®Šè¨˜å·ã€æ§˜ã€…ãªãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã®èª­ã¿ä¸Šã’ã‚’å¾“æ¥ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãªã—ã§ã‚µãƒãƒ¼ãƒˆ
- **ãƒã‚¤ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**: ãƒ†ã‚­ã‚¹ãƒˆã‚¤ãƒ³ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã¨éŸ³å£°ã‚¢ã‚¦ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€é«˜å“è³ªãªéŸ³å£°å‡ºåŠ›ã‚’ç¶­æŒã—ãªãŒã‚‰150msã¨ã„ã†ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’å®Ÿç¾
- **å‘½ä»¤ã‚µãƒãƒ¼ãƒˆ**: è¨€èªã€æ–¹è¨€ã€æ„Ÿæƒ…ã€é€Ÿåº¦ã€éŸ³é‡ãªã©ã®æ§˜ã€…ãªå‘½ä»¤ã‚’ã‚µãƒãƒ¼ãƒˆ
- **AMD GPU ã‚µãƒãƒ¼ãƒˆ**: AMD GPUå‘ã‘ã®ROCmã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ï¼è©³ç´°ã¯[ROCmã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#rocm-amd-gpu-ã‚µãƒãƒ¼ãƒˆ)ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§


## ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

- [x] 2025/12

    - [x] Fun-CosyVoice3-0.5B-2512 åŸºæœ¬ãƒ¢ãƒ‡ãƒ«ã€RLãƒ¢ãƒ‡ãƒ«ã¨ãã®å­¦ç¿’/æ¨è«–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒªãƒªãƒ¼ã‚¹
    - [x] Fun-CosyVoice3-0.5B modelscope gradio spaceã‚’ãƒªãƒªãƒ¼ã‚¹

- [x] 2025/08

    - [x] NVIDIA Yuekai Zhangã®è²¢çŒ®ã«ã‚ˆã‚Šã€triton trtllmãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚µãƒãƒ¼ãƒˆã¨cosyvoice2 grpoå­¦ç¿’ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ 

- [x] 2025/07

    - [x] Fun-CosyVoice 3.0 è©•ä¾¡ã‚»ãƒƒãƒˆã‚’ãƒªãƒªãƒ¼ã‚¹

- [x] 2025/05

    - [x] CosyVoice2-0.5B vllmã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ 

- [x] 2024/12

    - [x] 25hz CosyVoice2-0.5Bã‚’ãƒªãƒªãƒ¼ã‚¹

- [x] 2024/09

    - [x] 25hz CosyVoice-300MåŸºæœ¬ãƒ¢ãƒ‡ãƒ«
    - [x] 25hz CosyVoice-300MéŸ³å£°å¤‰æ›æ©Ÿèƒ½

- [x] 2024/08

    - [x] Repetition Aware Sampling(RAS)æ¨è«–ã§llmã®å®‰å®šæ€§å‘ä¸Š
    - [x] ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ¨è«–ãƒ¢ãƒ¼ãƒ‰ã‚µãƒãƒ¼ãƒˆã€rtfæœ€é©åŒ–ã®ãŸã‚ã®kv cacheã¨sdpaã‚’å«ã‚€

- [x] 2024/07

    - [x] Flow matchingå­¦ç¿’ã‚µãƒãƒ¼ãƒˆ
    - [x] ttsfrdãŒåˆ©ç”¨ã§ããªã„å ´åˆã®WeTextProcessingã‚µãƒãƒ¼ãƒˆ
    - [x] Fastapiã‚µãƒ¼ãƒãƒ¼ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

## è©•ä¾¡

| ãƒ¢ãƒ‡ãƒ« | ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ | ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º | test-zh<br>CER (%) â†“ | test-zh<br>SS (%) â†‘ | test-en<br>WER (%) â†“ | test-en<br>SS (%) â†‘ | test-hard<br>CER (%) â†“ | test-hard<br>SS (%) â†‘ |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| Human | - | - | 1.26 | 75.5 | 2.14 | 73.4 | - | - |
| Seed-TTS | âŒ | - | 1.12 | 79.6 | 2.25 | 76.2 | 7.59 | 77.6 |
| MiniMax-Speech | âŒ | - | 0.83 | 78.3 | 1.65 | 69.2 | - | - |
| F5-TTS | âœ… | 0.3B | 1.52 | 74.1 | 2.00 | 64.7 | 8.67 | 71.3 |
| Spark TTS | âœ… | 0.5B | 1.2 | 66.0 | 1.98 | 57.3 | - | - |
| CosyVoice2 | âœ… | 0.5B | 1.45 | 75.7 | 2.57 | 65.9 | 6.83 | 72.4 |
| FireRedTTS2 | âœ… | 1.5B | 1.14 | 73.2 | 1.95 | 66.5 | - | - |
| Index-TTS2 | âœ… | 1.5B | 1.03 | 76.5 | 2.23 | 70.6 | 7.12 | 75.5 |
| VibeVoice-1.5B | âœ… | 1.5B | 1.16 | 74.4 | 3.04 | 68.9 | - | - |
| VibeVoice-Realtime | âœ… | 0.5B | - | - | 2.05 | 63.3 | - | - |
| HiggsAudio-v2 | âœ… | 3B | 1.50 | 74.0 | 2.44 | 67.7 | - | - |
| VoxCPM | âœ… | 0.5B | 0.93 | 77.2 | 1.85 | 72.9 | 8.87 | 73.0 |
| GLM-TTS | âœ… | 1.5B | 1.03 | 76.1 | - | - | - | - |
| GLM-TTS RL | âœ… | 1.5B | 0.89 | 76.4 | - | - | - | - |
| Fun-CosyVoice3-0.5B-2512 | âœ… | 0.5B | 1.21 | 78.0 | 2.24 | 71.8 | 6.71 | 75.8 |
| Fun-CosyVoice3-0.5B-2512_RL | âœ… | 0.5B | 0.81 | 77.4 | 1.68 | 69.5 | 5.44 | 75.0 |


## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

- ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
    ``` sh
    git clone --recursive https://github.com/FunAudioLLM/CosyVoice.git
    # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã§ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¯ãƒ­ãƒ¼ãƒ³ã«å¤±æ•—ã—ãŸå ´åˆã€æˆåŠŸã™ã‚‹ã¾ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
    cd CosyVoice
    git submodule update --init --recursive
    ```

- Condaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: https://docs.conda.io/en/latest/miniconda.html ã‚’å‚ç…§ã—ã¦ãã ã•ã„
- Condaç’°å¢ƒã®ä½œæˆ:

    ``` sh
    conda create -n cosyvoice -y python=3.10
    conda activate cosyvoice
    pip install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ --trusted-host=mirrors.aliyun.com

    # soxäº’æ›æ€§ã®å•é¡Œã«é­é‡ã™ã‚‹å ´åˆ
    # ubuntu
    sudo apt-get install sox libsox-dev
    # centos
    sudo yum install sox sox-devel
    ```

### ãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

äº‹å‰å­¦ç¿’æ¸ˆã¿ã®`Fun-CosyVoice3-0.5B`ã€`CosyVoice2-0.5B`ã€`CosyVoice-300M`ã€`CosyVoice-300M-SFT`ã€`CosyVoice-300M-Instruct`ãƒ¢ãƒ‡ãƒ«ã¨`CosyVoice-ttsfrd`ãƒªã‚½ãƒ¼ã‚¹ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å¼·ããŠå‹§ã‚ã—ã¾ã™ã€‚

``` python
# modelscope SDKã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
from modelscope import snapshot_download
snapshot_download('FunAudioLLM/Fun-CosyVoice3-0.5B-2512', local_dir='pretrained_models/Fun-CosyVoice3-0.5B')
snapshot_download('iic/CosyVoice2-0.5B', local_dir='pretrained_models/CosyVoice2-0.5B')
snapshot_download('iic/CosyVoice-300M', local_dir='pretrained_models/CosyVoice-300M')
snapshot_download('iic/CosyVoice-300M-SFT', local_dir='pretrained_models/CosyVoice-300M-SFT')
snapshot_download('iic/CosyVoice-300M-Instruct', local_dir='pretrained_models/CosyVoice-300M-Instruct')
snapshot_download('iic/CosyVoice-ttsfrd', local_dir='pretrained_models/CosyVoice-ttsfrd')

# æµ·å¤–ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã€huggingface SDKã«ã‚ˆã‚‹ãƒ¢ãƒ‡ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
from huggingface_hub import snapshot_download
snapshot_download('FunAudioLLM/Fun-CosyVoice3-0.5B-2512', local_dir='pretrained_models/Fun-CosyVoice3-0.5B')
snapshot_download('FunAudioLLM/CosyVoice2-0.5B', local_dir='pretrained_models/CosyVoice2-0.5B')
snapshot_download('FunAudioLLM/CosyVoice-300M', local_dir='pretrained_models/CosyVoice-300M')
snapshot_download('FunAudioLLM/CosyVoice-300M-SFT', local_dir='pretrained_models/CosyVoice-300M-SFT')
snapshot_download('FunAudioLLM/CosyVoice-300M-Instruct', local_dir='pretrained_models/CosyVoice-300M-Instruct')
snapshot_download('FunAudioLLM/CosyVoice-ttsfrd', local_dir='pretrained_models/CosyVoice-ttsfrd')
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€`ttsfrd`ãƒªã‚½ãƒ¼ã‚¹ã‚’è§£å‡ã—ã€`ttsfrd`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã€ã‚ˆã‚Šè‰¯ã„ãƒ†ã‚­ã‚¹ãƒˆæ­£è¦åŒ–æ€§èƒ½ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

ãŸã ã—ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯å¿…é ˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚`ttsfrd`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãªã„å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§wetextã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

``` sh
cd pretrained_models/CosyVoice-ttsfrd/
unzip resource.zip -d .
pip install ttsfrd_dependency-0.1-py3-none-any.whl
pip install ttsfrd-0.4.2-cp310-cp310-linux_x86_64.whl
```

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

ã‚ˆã‚Šè‰¯ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãŸã‚ã€`Fun-CosyVoice3-0.5B`ã®ä½¿ç”¨ã‚’å¼·ããŠå‹§ã‚ã—ã¾ã™ã€‚
å„ãƒ¢ãƒ‡ãƒ«ã®è©³ç´°ãªä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã¯`example.py`ã®ã‚³ãƒ¼ãƒ‰ã«å¾“ã£ã¦ãã ã•ã„ã€‚
```sh
python example.py
```

#### vLLMä½¿ç”¨æ–¹æ³•
CosyVoice2/3ã¯ç¾åœ¨**vLLM 0.11.x+ (V1ã‚¨ãƒ³ã‚¸ãƒ³)**ã¨**vLLM 0.9.0 (ãƒ¬ã‚¬ã‚·ãƒ¼)**ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚
å¤ã„vllmãƒãƒ¼ã‚¸ãƒ§ãƒ³(<0.9.0)ã¯CosyVoiceæ¨è«–ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚‰ãšã€ãã®é–“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹ï¼š0.10.xï¼‰ã¯ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

`vllm`ã«ã¯å¤šãã®ç‰¹å®šã®è¦ä»¶ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŒvllmã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å ´åˆã‚„å¤ã„ç’°å¢ƒãŒç ´æã—ãŸå ´åˆã«å‚™ãˆã¦ã€æ–°ã—ã„ç’°å¢ƒã‚’ä½œæˆã§ãã¾ã™ã€‚

``` sh
conda create -n cosyvoice_vllm --clone cosyvoice
conda activate cosyvoice_vllm
# for vllm==0.9.0
pip install vllm==v0.9.0 transformers==4.51.3 numpy==1.26.4 -i https://mirrors.aliyun.com/pypi/simple/ --trusted-host=mirrors.aliyun.com
# for vllm>=0.11.0
pip install vllm==v0.11.0 transformers==4.57.1 numpy==1.26.4 -i https://mirrors.aliyun.com/pypi/simple/ --trusted-host=mirrors.aliyun.com
python vllm_example.py
```

#### Webãƒ‡ãƒ¢ã®é–‹å§‹

Webãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸ã‚’ä½¿ã£ã¦CosyVoiceã‚’ç´ æ—©ãç†è§£ã§ãã¾ã™ã€‚

è©³ç´°ã¯ãƒ‡ãƒ¢Webã‚µã‚¤ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

``` python
# sftæ¨è«–ã®å ´åˆã¯iic/CosyVoice-300M-SFTã«å¤‰æ›´ã€instructæ¨è«–ã®å ´åˆã¯iic/CosyVoice-300M-Instructã«å¤‰æ›´
python3 webui.py --port 50000 --model_dir pretrained_models/CosyVoice-300M
```

#### é«˜åº¦ãªä½¿ç”¨æ–¹æ³•

ä¸Šç´šè€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãŸã‚ã«ã€`examples/libritts`ã§å­¦ç¿’ãŠã‚ˆã³æ¨è«–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

### ROCm (AMD GPU) ã‚µãƒãƒ¼ãƒˆ

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯AMD GPUå‘ã‘ã®å®Ÿé¨“çš„ãªROCmã‚µãƒãƒ¼ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ROCmå®Ÿè£…ã¯ä»¥ä¸‹ã§ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼š
- **GPU**: AMD Radeon Graphics (RDNA 3/Strix Halo)
- **ROCmãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 7.1.1
- **PyTorch**: 2.9.1+rocm7.1.1
- **torchaudio**: 2.9.0+rocm7.1.1

#### Dockerã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰

AMD GPUã§CosyVoiceã‚’å®Ÿè¡Œã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯Dockerã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ï¼š

```bash
cd docker
docker compose -f docker-compose.rocm.yml up --build
```

Webã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯`http://localhost:7860`ã§åˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™

#### æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. Condaç’°å¢ƒã®ä½œæˆã¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
```bash
conda create -n cosyvoice -y python=3.10
conda activate cosyvoice
pip install -r requirements-rocm.txt
```

2. ROCmæœ€é©åŒ–ç‰ˆPyTorchã¨torchaudioã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
```bash
pip uninstall -y torch torchvision torchaudio
pip install 'torch==2.9.1+rocm7.1.1.lw.git351ff442' \
            'torchaudio==2.9.0+rocm7.1.1.gite3c6ee2b' \
            --find-links https://repo.radeon.com/rocm/manylinux/rocm-rel-7.1.1/
```

3. ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ç”¨pyniniã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
```bash
conda install -y -c conda-forge pynini==2.1.5
```

4. é€šå¸¸é€šã‚Šæ¨è«–ã‚’å®Ÿè¡Œï¼ˆGPUã¯è‡ªå‹•çš„ã«æ¤œå‡ºã•ã‚Œã¾ã™ï¼‰

**æ³¨**: ROCmã‚µãƒãƒ¼ãƒˆã¯å®Ÿé¨“çš„ã§ã™ã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯GPUãƒ¢ãƒ‡ãƒ«ã¨ROCmãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

#### ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ãƒ“ãƒ«ãƒ‰

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ãŸã„å ´åˆã€ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

``` sh
cd runtime/python
docker build -t cosyvoice:v1.0 .
# instructæ¨è«–ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯iic/CosyVoice-300Mã‚’iic/CosyVoice-300M-Instructã«å¤‰æ›´
# grpcä½¿ç”¨ã®å ´åˆ
docker run -d --runtime=nvidia -p 50000:50000 cosyvoice:v1.0 /bin/bash -c "cd /opt/CosyVoice/CosyVoice/runtime/python/grpc && python3 server.py --port 50000 --max_conc 4 --model_dir iic/CosyVoice-300M && sleep infinity"
cd grpc && python3 client.py --port 50000 --mode <sft|zero_shot|cross_lingual|instruct>
# fastapiä½¿ç”¨ã®å ´åˆ
docker run -d --runtime=nvidia -p 50000:50000 cosyvoice:v1.0 /bin/bash -c "cd /opt/CosyVoice/CosyVoice/runtime/python/fastapi && python3 server.py --port 50000 --model_dir iic/CosyVoice-300M && sleep infinity"
cd fastapi && python3 client.py --port 50000 --mode <sft|zero_shot|cross_lingual|instruct>
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤å‘ã‘Nvidia TensorRT-LLMã®ä½¿ç”¨

TensorRT-LLMã‚’ä½¿ç”¨ã—ã¦cosyvoice2 llmã‚’é«˜é€ŸåŒ–ã™ã‚‹ã¨ã€huggingface transformerså®Ÿè£…ã¨æ¯”è¼ƒã—ã¦4å€ã®é«˜é€ŸåŒ–ãŒå¯èƒ½ã§ã™ã€‚
ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆï¼š

``` sh
cd runtime/triton_trtllm
docker compose up -d
```
è©³ç´°ã¯[ã“ã¡ã‚‰](https://github.com/FunAudioLLM/CosyVoice/tree/main/runtime/triton_trtllm)ã‚’ç¢ºèªã—ã¦ãã ã•ã„

## ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

[Github Issues](https://github.com/FunAudioLLM/CosyVoice/issues)ã§ç›´æ¥ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã§ãã¾ã™ã€‚

ã¾ãŸã€QRã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦å…¬å¼Dingdingãƒãƒ£ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«å‚åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

<img src="./asset/dingding.png" width="250px">

## è¬è¾

1. [FunASR](https://github.com/modelscope/FunASR)ã‹ã‚‰å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’å€Ÿç”¨ã—ã¾ã—ãŸ
2. [FunCodec](https://github.com/modelscope/FunCodec)ã‹ã‚‰å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’å€Ÿç”¨ã—ã¾ã—ãŸ
3. [Matcha-TTS](https://github.com/shivammehta25/Matcha-TTS)ã‹ã‚‰å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’å€Ÿç”¨ã—ã¾ã—ãŸ
4. [AcademiCodec](https://github.com/yangdongchao/AcademiCodec)ã‹ã‚‰å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’å€Ÿç”¨ã—ã¾ã—ãŸ
5. [WeNet](https://github.com/wenet-e2e/wenet)ã‹ã‚‰å¤šãã®ã‚³ãƒ¼ãƒ‰ã‚’å€Ÿç”¨ã—ã¾ã—ãŸ

## å¼•ç”¨

``` bibtex
@article{du2024cosyvoice,
  title={Cosyvoice: A scalable multilingual zero-shot text-to-speech synthesizer based on supervised semantic tokens},
  author={Du, Zhihao and Chen, Qian and Zhang, Shiliang and Hu, Kai and Lu, Heng and Yang, Yexin and Hu, Hangrui and Zheng, Siqi and Gu, Yue and Ma, Ziyang and others},
  journal={arXiv preprint arXiv:2407.05407},
  year={2024}
}

@article{du2024cosyvoice,
  title={Cosyvoice 2: Scalable streaming speech synthesis with large language models},
  author={Du, Zhihao and Wang, Yuxuan and Chen, Qian and Shi, Xian and Lv, Xiang and Zhao, Tianyu and Gao, Zhifu and Yang, Yexin and Gao, Changfeng and Wang, Hui and others},
  journal={arXiv preprint arXiv:2412.10117},
  year={2024}
}

@article{du2025cosyvoice,
  title={CosyVoice 3: Towards In-the-wild Speech Generation via Scaling-up and Post-training},
  author={Du, Zhihao and Gao, Changfeng and Wang, Yuxuan and Yu, Fan and Zhao, Tianyu and Wang, Hao and Lv, Xiang and Wang, Hui and Shi, Xian and An, Keyu and others},
  journal={arXiv preprint arXiv:2505.17589},
  year={2025}
}

@inproceedings{lyu2025build,
  title={Build LLM-Based Zero-Shot Streaming TTS System with Cosyvoice},
  author={Lyu, Xiang and Wang, Yuxuan and Zhao, Tianyu and Wang, Hao and Liu, Huadai and Du, Zhihao},
  booktitle={ICASSP 2025-2025 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)},
  pages={1--2},
  year={2025},
  organization={IEEE}
}
```

## å…è²¬äº‹é …
ä¸Šè¨˜ã§æä¾›ã•ã‚Œã‚‹å†…å®¹ã¯å­¦è¡“ç›®çš„ã®ã¿ã§ã‚ã‚Šã€æŠ€è¡“çš„æ©Ÿèƒ½ã‚’ç¤ºã™ã“ã¨ã‚’æ„å›³ã—ã¦ã„ã¾ã™ã€‚ä¸€éƒ¨ã®ä¾‹ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚½ãƒ¼ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‚ãªãŸã®æ¨©åˆ©ã‚’ä¾µå®³ã—ã¦ã„ã‚‹å ´åˆã¯ã€å‰Šé™¤ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ã”é€£çµ¡ãã ã•ã„ã€‚
